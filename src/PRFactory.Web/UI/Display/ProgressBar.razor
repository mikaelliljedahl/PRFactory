@using PRFactory.Web.UI.Display

<div class="progress @AdditionalClass" style="height: @HeightPx;">
    <div class="progress-bar @GetProgressClass()"
         role="progressbar"
         style="width: @Value%;"
         aria-valuenow="@Value"
         aria-valuemin="0"
         aria-valuemax="100">
        @if (ShowLabel)
        {
            <span>@Value%</span>
        }
        else if (!string.IsNullOrEmpty(Label))
        {
            <span>@Label</span>
        }
    </div>
</div>

@code {
    [Parameter]
    public int Value { get; set; } = 0;

    [Parameter]
    public string? Label { get; set; }

    [Parameter]
    public bool ShowLabel { get; set; } = false;

    [Parameter]
    public ProgressVariant Variant { get; set; } = ProgressVariant.Primary;

    [Parameter]
    public bool Striped { get; set; } = false;

    [Parameter]
    public bool Animated { get; set; } = false;

    [Parameter]
    public string HeightPx { get; set; } = "20px";

    [Parameter]
    public string? AdditionalClass { get; set; }

    private string GetProgressClass()
    {
        var classes = new List<string>();

        classes.Add(Variant switch
        {
            ProgressVariant.Success => "bg-success",
            ProgressVariant.Info => "bg-info",
            ProgressVariant.Warning => "bg-warning",
            ProgressVariant.Danger => "bg-danger",
            ProgressVariant.Secondary => "bg-secondary",
            _ => "bg-primary"
        });

        if (Striped || Animated)
        {
            classes.Add("progress-bar-striped");
        }

        if (Animated)
        {
            classes.Add("progress-bar-animated");
        }

        return string.Join(" ", classes);
    }
}
