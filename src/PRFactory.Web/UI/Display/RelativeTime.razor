<span title="@Timestamp.ToString("F", System.Globalization.CultureInfo.InvariantCulture)">
    @if (ShowIcon && !string.IsNullOrEmpty(Icon))
    {
        <i class="bi bi-@Icon me-1"></i>
    }
    @FormatTimestamp()
</span>

@code {
    [Parameter, EditorRequired] public DateTime Timestamp { get; set; }
    [Parameter] public bool ShowIcon { get; set; }
    [Parameter] public string Icon { get; set; } = "clock";
    [Parameter] public string? Prefix { get; set; }

    private string FormatTimestamp()
    {
        var now = DateTime.UtcNow;
        var diff = now - Timestamp;

        var prefix = !string.IsNullOrEmpty(Prefix) ? Prefix + " " : "";

        if (diff.TotalMinutes < 1)
            return prefix + "Just now";
        if (diff.TotalMinutes < 60)
            return prefix + $"{(int)diff.TotalMinutes} minutes ago";
        if (diff.TotalHours < 24)
            return prefix + $"{(int)diff.TotalHours} hours ago";
        if (diff.TotalDays < 7)
            return prefix + $"{(int)diff.TotalDays} days ago";

        return prefix + Timestamp.ToString("MMM dd, yyyy 'at' h:mm tt", System.Globalization.CultureInfo.InvariantCulture);
    }
}
