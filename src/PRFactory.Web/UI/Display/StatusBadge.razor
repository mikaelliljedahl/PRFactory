@using PRFactory.Domain.ValueObjects

<span class="@BadgeClass">
    @if (!string.IsNullOrEmpty(Icon))
    {
        <i class="bi bi-@Icon me-1"></i>
    }
    @DisplayText
</span>

@code {
    [Parameter] public WorkflowState State { get; set; }
    [Parameter] public string? CustomText { get; set; }
    [Parameter] public string? Icon { get; set; }

    private string DisplayText => CustomText ?? State switch
    {
        WorkflowState.Triggered => "Triggered",
        WorkflowState.Analyzing => "Analyzing Repository",
        WorkflowState.TicketUpdateGenerated => "Ticket Update Generated",
        WorkflowState.TicketUpdateUnderReview => "Ticket Update Under Review",
        WorkflowState.TicketUpdateRejected => "Ticket Update Rejected",
        WorkflowState.TicketUpdateApproved => "Ticket Update Approved",
        WorkflowState.TicketUpdatePosted => "Ticket Update Posted",
        WorkflowState.QuestionsPosted => "Questions Posted",
        WorkflowState.AwaitingAnswers => "Awaiting Answers",
        WorkflowState.AnswersReceived => "Answers Received",
        WorkflowState.Planning => "Planning",
        WorkflowState.PlanPosted => "Plan Posted",
        WorkflowState.PlanUnderReview => "Plan Under Review",
        WorkflowState.PlanApproved => "Plan Approved",
        WorkflowState.PlanRejected => "Plan Rejected",
        WorkflowState.Implementing => "Implementing",
        WorkflowState.ImplementationFailed => "Implementation Failed",
        WorkflowState.PRCreated => "PR Created",
        WorkflowState.InReview => "In Review",
        WorkflowState.Completed => "Completed",
        WorkflowState.Failed => "Failed",
        WorkflowState.Cancelled => "Cancelled",
        _ => State.ToString()
    };

    private string BadgeClass => $"badge {GetBadgeColor()}";

    private string GetBadgeColor() => State switch
    {
        WorkflowState.Completed => "bg-success",
        WorkflowState.Failed or WorkflowState.ImplementationFailed => "bg-danger",
        WorkflowState.Cancelled => "bg-secondary",
        WorkflowState.AwaitingAnswers or WorkflowState.PlanUnderReview or WorkflowState.InReview or WorkflowState.TicketUpdateUnderReview => "bg-warning",
        WorkflowState.PRCreated => "bg-info",
        WorkflowState.Triggered => "bg-secondary",
        WorkflowState.PlanRejected or WorkflowState.TicketUpdateRejected => "bg-danger",
        WorkflowState.PlanApproved or WorkflowState.TicketUpdateApproved => "bg-success",
        _ => "bg-primary"
    };
}
